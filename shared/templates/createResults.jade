include ./mixins/code-freq-table.jade
include ./mixins/empty-table.jade

.scrollable-parent
  // Nav tabs
  .btn-toolbar(style="display:flex;justify-content:right;line-height:45px;")
    if !user || !user.name
      a.btn.btn-github.btn-social(href='/auth/github?returnTo=/create')
        i.fa.fa-github
        | Sign in with GitHub to save
    else
      if githubSet && !isDirty
        span#savedToGithub.pull-left
          | Saved as: 
          a(href=githubSet.repoUrl, target="_blank")= `${githubSet.name.substr(0, 20)}...`
      else if isDirty
        button#updateGit.btn.btn-warning(type="button", data-toggle="modal", data-target="#saveModal") Save
      else
        button.btn.btn-warning#saveToGit(type="button", data-toggle="modal", data-target="#saveModal") Save to GitHub
    .btn-group
      button#downloadCodeSet.btn.btn-success Download code set
      button.btn.btn-success.dropdown-toggle(type='button', data-toggle='dropdown', aria-haspopup='true', aria-expanded='false')
        span.caret
        span.sr-only Toggle Dropdown
      ul.dropdown-menu
        li#downloadCodes
          a(href='#') Download codes
        li#downloadMeta
          a(href='#') Download meta
        li.divider(role='separator')
        li#downloadAll
          a(href='#') Download all
  #tree(style='overflow-y:auto; height:calc(100% - 50px)')
// Modal
#saveModal.modal.fade(tabindex='-1', role='dialog', aria-labelledby='saveModalLabel')
  .modal-dialog(role='document')
    .modal-content
      form(action="")
        .modal-header
          button.close(type='button', data-dismiss='modal', aria-label='Close')
            span(aria-hidden='true') Ã—
          h4#saveModalLabel.modal-title= `Save code set ${githubSet ? 'changes ' : ''}to GitHub`
        .modal-body
          p This allows you to publish and share your code sets with other researchers
          if githubSet
            .form-group
              label(for='name') Name
              input#firstInput.form-control(type='text', name='name', value=githubSet.name.split(' | ')[0], readonly)
          else
            .form-group
              label(for='name') Name
              input#firstInput.form-control(type='text',placeholder='A name for your code set - try to make it descriptive!', name='name')
          .form-group
            label(for='description') Description
            textarea.form-control(rows='3',placeholder='Tell us a bit more about what the code set is.', name='description')
              = githubSet ? githubSet.description : ''
          if githubSet
            .form-group
              label(for='message') What's changed?
              textarea.form-control(rows='3',placeholder='Tell us a bit more about what changes you\'ve made and why', name='message')
        .modal-footer
          button.btn.btn-default.hide-on-submit(type='button', data-dismiss='modal') Cancel
          button.btn.btn-primary.hide-on-submit(type='submit') Save to GitHub
          button.btn.btn-primary.disabled#loader(type='button',style='display:none')
            i.fa.fa-refresh.fa-spin.fa-fw